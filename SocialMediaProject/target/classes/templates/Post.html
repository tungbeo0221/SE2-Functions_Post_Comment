<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title th:if="${error}"> Error </title>
  <title th:unless="${error}" th:text="${post.title}"> Post</title>
  <link rel="stylesheet" th:href="@{/style/posts.css}">
  <link href='https://fonts.googleapis.com/css?family=Outfit' rel='stylesheet'>

</head>
<body>
  <div th:insert="header"></div>
  <div class="d-flex justify-content-center" style="margin: 10px;">
    <div th:if="${error}" class="alert alert-danger" role="alert">
      Sorry, the post you requested doesn't exist!
    </div>
    <article th:unless="${error}">
      <div class="post-detail">
        <img 
          class="post-thumbnail" 
          src="https://picsum.photos/seed/picsum/200/300"
          alt="thumbnail"
        >
        <div class="post-user-tags">
          <div class="post-user">
            <img 
              class="user-avatar" 
              src="https://fastly.picsum.photos/id/237/200/300.jpg?hmac=TmmQSbShHz9CdQm0NkEjx1Dyh_Y984R9LpNrpvH2D_U" 
              alt="avatar"
            >
            <div class="user-username-post-date">
              <span class="user-username">David Johnson</span>
              <span class="post-date">8 hours ago</span>
            </div>
            <div class="post-tags">
              <div class="post-tag">
                # Technology
              </div>
              <div class="post-tag">
                # Artificial Intelligence
              </div>
              <div class="post-tag">
                # Technology
              </div>
            </div>
          </div>
        </div>

      </div>
      <h1 class="post-title" th:utext="${post.title}">Title</h1>
      <span class="post-content" th:utext="${post.content}">Content</span>
    </article>
    

    <div class="post-line"></div>

    <div class="comment-section">
      <!-- <div class="input-button-container">
        <div class="profile-picture"></div>
        <div  th:object="${newComment}" method="POST">
          <textarea class="comment-input"
                    placeholder="Comment..."
                    th:field="${newComment.content}"></textarea>
        </div>

        <button class="comment-button"
                th:onclick=" 'createComment(/*[[${post.id}]]*/)' "
        >Post</button>
      </div> -->
      <div class="comment-content-container">
        <div class="profile-picture"></div>
        <div>
        <div class="comment-option-container">
          <div th:each="comment : ${comments}" class="comment">
            <div th:text="${comment.content}"></div>
          </div>
        </div>
      </div>
    </div>
 </div>
  </div>
</body>
<script>
  function createComment(postId){
    var commentText = document.querySelector('.comment-input').value;
    var data = {
        content: commentText
    }
    fetch('/addComment', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    })
    .then(response => {
        if(!response.ok){
            throw new Error('Failed to post comment');
        }
        alert('Comment posted successfully');
        //reload or update the comment section
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Failed to post comment');
    });
    }
</script>
</html>
